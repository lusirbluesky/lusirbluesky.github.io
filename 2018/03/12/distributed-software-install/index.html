<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>
<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "3be6295f"
    });
  daovoice('update');
  </script>














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.ico?v=5.1.4">






  <meta name="keywords" content="bigdata," />





  <link rel="alternate" href="/atom.xml" title="phoenix's blog" type="application/atom+xml" />






<meta name="description" content="#分布式集群 ###前置事项  规划集群  Linux存储、系统及版本选择  Ubuntu16.x Centos6.x 主节点一般选大内存，小存储 主节点一般比较消耗内存 一般32G/64G,奢侈128G/256G 硬盘可是视情况选择   数据节点一般选择大存储，小内存 数据节点一般消耗磁盘存储空间 一般是2T/4T 内存4G/8G     安装系统  阿里云选择镜像或者自建集群系统盘安装系统 K">
<meta name="keywords" content="bigdata">
<meta property="og:type" content="article">
<meta property="og:title" content="分布式集群">
<meta property="og:url" content="http://www.bluedreams.top/2018/03/12/distributed-software-install/index.html">
<meta property="og:site_name" content="phoenix&#39;s blog">
<meta property="og:description" content="#分布式集群 ###前置事项  规划集群  Linux存储、系统及版本选择  Ubuntu16.x Centos6.x 主节点一般选大内存，小存储 主节点一般比较消耗内存 一般32G/64G,奢侈128G/256G 硬盘可是视情况选择   数据节点一般选择大存储，小内存 数据节点一般消耗磁盘存储空间 一般是2T/4T 内存4G/8G     安装系统  阿里云选择镜像或者自建集群系统盘安装系统 K">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-03-11T22:42:57.871Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分布式集群">
<meta name="twitter:description" content="#分布式集群 ###前置事项  规划集群  Linux存储、系统及版本选择  Ubuntu16.x Centos6.x 主节点一般选大内存，小存储 主节点一般比较消耗内存 一般32G/64G,奢侈128G/256G 硬盘可是视情况选择   数据节点一般选择大存储，小内存 数据节点一般消耗磁盘存储空间 一般是2T/4T 内存4G/8G     安装系统  阿里云选择镜像或者自建集群系统盘安装系统 K">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'strongant'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.bluedreams.top/2018/03/12/distributed-software-install/"/>





  <title>分布式集群 | phoenix's blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8aec9d5d23a296259b96bdbe88c11656";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
		<!--添加github的丝带-->
		<a href="https://lusirbluesky.github.io" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
	</div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">phoenix's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">In the future you will appreciate your desperate effort now</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.bluedreams.top/2018/03/12/distributed-software-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="phoenix">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/hz-avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="phoenix's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">分布式集群</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-12T06:37:43+08:00">
                2018-03-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bigdata/" itemprop="url" rel="index">
                    <span itemprop="name">bigdata</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/03/12/distributed-software-install/" class="leancloud_visitors" data-flag-title="分布式集群">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
				 <span>℃</span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,352
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  20
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>#分布式集群</p>
<p>###前置事项</p>
<ul>
<li><p>规划集群</p>
</li>
<li><p>Linux存储、系统及版本选择</p>
<ul>
<li>Ubuntu16.x</li>
<li>Centos6.x</li>
<li>主节点一般选大内存，小存储<ul>
<li>主节点一般比较消耗内存</li>
<li>一般32G/64G,奢侈128G/256G</li>
<li>硬盘可是视情况选择</li>
</ul>
</li>
<li>数据节点一般选择大存储，小内存<ul>
<li>数据节点一般消耗磁盘存储空间</li>
<li>一般是2T/4T</li>
<li>内存4G/8G</li>
</ul>
</li>
</ul>
</li>
<li><p>安装系统</p>
<ul>
<li>阿里云选择镜像或者自建集群系统盘安装系统</li>
<li>KVM虚拟化技术</li>
<li>虚拟机安装（VM or Vbox）<ul>
<li>网络NAT</li>
<li>配置网关，注意IP地址</li>
<li>可以选择安装单台或者安装完一台后复制多份（修改）</li>
</ul>
</li>
</ul>
</li>
<li><p>安装节点系统</p>
<ul>
<li><p>安装完成后注意事项</p>
<ul>
<li><p>修改主机名</p>
<ul>
<li>临时</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname vm01</span><br></pre></td></tr></table></figure>


  - 永久

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/network</span><br></pre></td></tr></table></figure>


  &gt; 将<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  &gt;</span><br><span class="line">  &gt; hosts文件修改后立刻生效</span><br><span class="line"></span><br><span class="line">  ​</span><br><span class="line"></span><br><span class="line">- 修改MAC地址</span><br><span class="line"></span><br><span class="line">  - 方式1</span><br><span class="line"></span><br><span class="line">    - 如果复制centos</span><br><span class="line">    - 启动后选择**我已复制**</span><br><span class="line">    - 删掉```rm -rf /etc/udev/rules.d/70-persistent-net.rules```文件</span><br><span class="line">    - 重启后会自动生成对应新文件</span><br><span class="line">    - 查看```cat /etc/udev/rules.d/70-persistent-net.rules```文件的MAC地址并记录</span><br><span class="line">    - 打开```vim /etc/sysconfig/network-scripts/ifcfg-eth0```修改__HWADDR__，改为刚刚记录下来的MAC地址值</span><br><span class="line">    - 重启网络服务或重启该节点服务器生效</span><br><span class="line"></span><br><span class="line">    ```shell</span><br><span class="line">    # 重启节点主机</span><br><span class="line">    halt</span><br><span class="line">    shutdown -r now</span><br><span class="line">    # 重启网络服务</span><br><span class="line">    service network stop</span><br><span class="line">    service network start</span><br><span class="line">    service network restart</span><br></pre></td></tr></table></figure>


  - 方式2

    - vmware设置-网络适配器-高级-生成MAC地址（多生成几次，以免重复）

    - 修改MAC地址<figure class="highlight vim"><figcaption><span>/etc/udev/rules.d/70-persistent-net.rules```为上面生成的值并删掉多余的eth1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">  或者</span><br><span class="line">    </span><br><span class="line">- 修改```<span class="keyword">vim</span> /etc/udev/rules.d/<span class="number">70</span>-persistent-net.rules```文件，删掉eth0相关的配置，将eth1为eth0即可</span><br><span class="line">    </span><br><span class="line">- 修改```<span class="keyword">vim</span> /etc/sysconfig/network-scripts/ifcfg-eth0</span><br></pre></td></tr></table></figure>


    - 将HWADDR值改成最新生成的MAC地址

    - 立即重启<figure class="highlight plain"><figcaption><span>-r now```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    &gt; MAC地址样例</span><br><span class="line">    &gt;</span><br><span class="line">    &gt; 00:0C:29:CB:E8:AA</span><br><span class="line">    &gt; 00:0C:29:DA:6B:C9</span><br><span class="line"></span><br><span class="line">- 修改ifcfg-eth0</span><br><span class="line"></span><br><span class="line">  ```shell</span><br><span class="line">  vim /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">  #修改</span><br><span class="line">  DEVICE=&quot;eth0&quot;</span><br><span class="line">  HWADDR=&quot;00:0C:29:FD:FF:2A&quot;</span><br><span class="line">  ONBOOT=&quot;yes&quot;</span><br><span class="line">  IPADDR=192.168.1.31</span><br><span class="line">  NETMASK=255.255.255.0</span><br><span class="line">  GATEWAY=192.168.1.1</span><br><span class="line">  BOOTPROTO=static</span><br></pre></td></tr></table></figure>


- 网络接口配置文件说明

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet       #网卡类型</span><br><span class="line">DEVICE=eth0         #网卡接口名称</span><br><span class="line">ONBOOT=yes          #系统启动时是否自动加载</span><br><span class="line">BOOTPROTO=static    #启用地址协议 --static:静态协议 --bootp协议 --dhcp协议</span><br><span class="line">IPADDR=192.168.1.11      #网卡IP地址</span><br><span class="line">NETMASK=255.255.255.0    #网卡网络地址</span><br><span class="line">GATEWAY=192.168.1.1      #网卡网关地址</span><br><span class="line">DNS1=10.203.104.41       #网卡DNS地址</span><br><span class="line">HWADDR=00:0C:29:13:5D:74 #网卡设备MAC地址</span><br><span class="line">BROADCAST=192.168.1.255  #网卡广播地址</span><br></pre></td></tr></table></figure>


- 重启网卡

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/network stop</span><br><span class="line">/etc/init.d/network start</span><br></pre></td></tr></table></figure>


- 网络服务的启动与关闭

  - 方式1

    <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service network stop #关闭网络服务</span><br><span class="line">service network start #启动网络服务</span><br><span class="line">service network restart #重启网络服务</span><br></pre></td></tr></table></figure>


  - 方式2

    <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/network stop</span><br><span class="line">/etc/init.d/network start</span><br><span class="line">/etc/init.d/network restart</span><br></pre></td></tr></table></figure>


- 网卡接口关闭与激活

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifdown eth0 #关闭网络</span><br><span class="line">ifup eth0 #启动网络</span><br></pre></td></tr></table></figure>


- 网卡状态查询

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network status</span><br></pre></td></tr></table></figure>


- 设置相同时区并永久同步相同时钟

  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 1.修改时区为Asia/Shanghai</span><br><span class="line">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"><span class="meta">#</span> 2.安装ntp服务器</span><br><span class="line">yum install ntp</span><br><span class="line"><span class="meta">#</span> 3.同步时间命令</span><br><span class="line">ntpdate cn.pool.ntp.org</span><br></pre></td></tr></table></figure>


  - [参考01](http://blog.csdn.net/testcs_dn/article/details/39803919)
  - [参考02](http://blog.csdn.net/wangmj518/article/details/49683305)
</code></pre><ul>
<li><p>永久关闭放火墙</p>
<ul>
<li><p>服务器一般对外网开放某些端口，对内网永久关闭防火墙</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 临时关闭和永久关闭防火墙</span><br><span class="line">service iptables stop &amp;&amp; chkconfig iptables off</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>配置免密登录</p>
<ul>
<li>一般是配置主节点到自己及其他从节点的免密登录</li>
<li>也可以配置集群中所有节点自己与自己及其他节点的免密登录</li>
</ul>
</li>
<li><p>安装一些软件包</p>
</li>
<li><p>配置YUM源</p>
</li>
</ul>
<blockquote>
<p>集群搭建需要注意的两点是：</p>
<p>1.<strong>关闭内网防火墙</strong></p>
<p>2.<strong>时间一致性</strong></p>
</blockquote>
<h3 id="windows-Linux-OS是hosts文件"><a href="#windows-Linux-OS是hosts文件" class="headerlink" title="windows/Linux OS是hosts文件"></a>windows/Linux OS是hosts文件</h3><ul>
<li><p>位置</p>
<ul>
<li>windows</li>
</ul>
<blockquote>
<p>C:\Windows\System32\drivers\etc\hosts</p>
</blockquote>
<ul>
<li>Linux</li>
</ul>
<blockquote>
<p>/etc/hosts</p>
</blockquote>
</li>
<li><p>作用</p>
</li>
</ul>
<blockquote>
<ul>
<li>加快域名解析</li>
</ul>
<blockquote>
<p>对于要经常访问的网站，我们可以通过在hosts中配置域名和IP的映射关系，提高域名解析速度。由于有了映射关系，当我们输入域名计算机就能很快解析出IP，而不用请求网络上的DNS服务器。</p>
<blockquote>
<p>注意：IP与域名中间要有空格，IP地址一定要输入正确，不然就访问不了该网站了，可以通过运行CMD，输入“ping 网站域名” 来获得网站的IP地址！）这样访问速度就会快一点啦，因为他不需要经过DNS域名服务器进行IP地址的解析！</p>
</blockquote>
</blockquote>
<ul>
<li>方便局域网用户</li>
</ul>
<blockquote>
<p>在很多单位的局域网中，会有服务器提供给用户使用。但由于局域网中一般很少架设DNS服务器，访问这些服务器时，要输入难记的IP地址，这对不少人来说相当麻烦，现在可以分别给这些服务器取个容易记住的名字，然后在hosts中建立IP映射，这样以后访问的时候，只要输入这个服务器的名字就行了。</p>
</blockquote>
<ul>
<li>屏蔽网站</li>
</ul>
<blockquote>
<p>现在有很多网站不经过用户同意就将各种各样的插件安装到你的计算机中，其中不乏有病毒木马。对于这些网站我们可以利用Hosts把该网站的域名映射到一个错误的IP或本地计算机的IP，这样就不用访问了。在Windows系统中，约定 127.0.0.1为本地计算机的IP地址, 0.0.0.0是错误的IP地址。</p>
<p>这个网站影响我孩子的健康成长，我要屏蔽他，这样，计算机解析域名www.sex.com 时，就解析到本机IP或错误的IP，达到了屏蔽不健康网站的目的。</p>
<p>现在某些病毒，恶意程序会修改我们的host文件，导致我们无法访问某些网站，当发现某些网站不能访问时，我们可以进入hosts文件进行观察，如果是因为hosts文件造成的网站无法访问，删除病毒添加的语句，就可以对网站进行正常访问。</p>
</blockquote>
</blockquote>
<ul>
<li><p>执行<figure class="highlight plain"><figcaption><span>/etc/hosts```centos6.7中的hosts文件内容</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">&gt; ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">&gt; 192.168.10.150 node01 zk01 kafka01 storm01</span><br><span class="line">&gt; 192.168.10.151 node02 zk02 kafka02 storm02</span><br><span class="line">&gt; 192.168.10.152 node03 zk03 kafka03 storm03</span><br><span class="line"></span><br><span class="line">### CentOS 6 时间，时区，设置修改及时间同步</span><br><span class="line"></span><br><span class="line">- 时区</span><br><span class="line"></span><br><span class="line">  - 显示时区</span><br><span class="line"></span><br><span class="line">    - date --help 获取帮助</span><br><span class="line"></span><br><span class="line">    - date -R</span><br><span class="line"></span><br><span class="line">    - date +%z</span><br><span class="line"></span><br><span class="line">      ```shell</span><br><span class="line">      [root@node01 ~]#  date -R; date +%z</span><br><span class="line">      Mon, 29 Jan 2018 06:20:28 +0800</span><br><span class="line">      +0800</span><br></pre></td></tr></table></figure></p>
<pre><code>&gt; 主要就是后面的+0800，东八区
</code></pre><ul>
<li><p>修改时区</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>
<blockquote>
<p>时区的信息存在/usr/share/zoneinfo/下面，本机的时区信息存在/etc/localtime，利用tab键技巧，可以任意修改时区</p>
<p>tzselect，互动式命令</p>
</blockquote>
</li>
</ul>
</li>
<li><p>时间</p>
<ul>
<li><p>概念：Linux时间有两个</p>
</li>
<li><p>系统时间：也叫软件时间(sys)， 1970年1月1日到当前时间的秒数</p>
</li>
<li><p>BOIS时间：也叫硬件时间(hc)</p>
</li>
<li><p>显示时间</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# date;hwclock -r</span><br><span class="line">Mon Jan 29 06:37:19 CST 2018</span><br><span class="line">Mon 29 Jan 2018 06:37:23 AM CST  -0.954874 seconds</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置时间</p>
<ul>
<li><p>方式1：无网络环境</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# date -s 20180201</span><br><span class="line">Thu Feb  1 00:00:00 CST 2018</span><br><span class="line">[root@node01 ~]# date -s 16:30:00</span><br><span class="line">Thu Feb  1 16:30:00 CST 2018</span><br></pre></td></tr></table></figure>
<blockquote>
<p>没有网络的情况下可以用这个</p>
</blockquote>
</li>
<li><p>方式2：可以连接外网(ntpdate)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate time.windows.com &amp;&amp; hwclock -w</span><br></pre></td></tr></table></figure>
<blockquote>
<p>连网更新时间，如果成功，将系统时间，写入BOIS</p>
<p>hwclock -w 或 hwclock –systohc</p>
<p>可以做到crontab里</p>
</blockquote>
</li>
<li><p>方式3：启动ntpd服务，开启后2就不能用了</p>
<blockquote>
<p>先用ntpdate更新一下，确保时间不至于差别太大</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep ntp <span class="comment">#查询一下可安装了</span></span><br><span class="line">chkconfig --list | grep ntp <span class="comment">#看下服务情况</span></span><br><span class="line">chkconifg ntpd on</span><br><span class="line">service ntpd start 或/etc/init.d/ntpd start</span><br></pre></td></tr></table></figure>
<blockquote>
<p>必要的话，设置一下/etc/ntp.conf，再把服务reload一下。</p>
<p>ntp的知识参考一下鸟哥的服务器篇</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="软件相关"><a href="#软件相关" class="headerlink" title="软件相关"></a>软件相关</h3><ul>
<li><p>安装规划</p>
<ul>
<li><p>软件版本号</p>
</li>
<li><p>依赖其他环境或包</p>
</li>
<li><p>软件存放路径</p>
</li>
<li><p>解压安装路径</p>
</li>
<li><p>软件日志文件存放路径</p>
</li>
<li><p>软件临时数据文件存放路径</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /export/server# 存放软件安装或解压文件</span><br><span class="line">mkdir -p /export/software# 存放软件包</span><br><span class="line">mkdir -p /export/data# 存放临时数据文件</span><br><span class="line">mkdir -p /export/log# 存放日志文件</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /export/server &amp;&amp; mkdir -p /export/software &amp;&amp; mkdir -p /export/data &amp;&amp; mkdir -p /export/log</span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>安装流程</p>
<ul>
<li><p>将指定软件包(xxx.tar.gz)下载或者上传到A节点服务器</p>
</li>
<li><p>解压到指定路径</p>
</li>
<li><p>重命名或创建软链接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv zookeeperxxx zk</span><br><span class="line">mv jdk1.8xxx jdk</span><br><span class="line">ln -s zookeeperxxx zk</span><br><span class="line">ln -s jdk1.8xxx jdk</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建日志文件、临时数据文件等文件的存放路径</p>
</li>
<li><p>修改配置文件</p>
</li>
<li><p>配置环境变量</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>
<blockquote>
<p>按Go跳到文件最后一行</p>
</blockquote>
</li>
<li><p>修改host映射</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br></pre></td></tr></table></figure>
</li>
<li><p>分发到集群的其他相关节点</p>
<ul>
<li>软件包解压安装全路径</li>
<li>临时数据文件创建路径<ul>
<li>有的需要自己创建，有的自动创建</li>
<li>有的分发后无需修改，有的分发后需要修改</li>
</ul>
</li>
<li>如果节点环境变量文件相同可以分发，否则最好自己手动配置环境变量</li>
</ul>
</li>
<li><p>更新环境变量</p>
<ul>
<li>可以重启或者执行如下命令</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以使用XShell或SecureCRT下面的回话窗口同时在多节点执行命令</p>
</blockquote>
</li>
<li><p>自定义启动脚本/一键启动脚本/便捷个性化脚本</p>
</li>
</ul>
</li>
<li><p>JDK8安装</p>
<ul>
<li>查看是否安装</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep java</span><br></pre></td></tr></table></figure>
<ul>
<li>卸载自带openJDK</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rpm -e --nodeps java-1.7.0-openjdk-1.7.0.45-2.4.3.3.el6.x86_64</span><br><span class="line"></span><br><span class="line"> rpm -e --nodeps java-1.6.0-openjdk-1.6.0.0-1.66.1.13.0.el6.x86_64</span><br><span class="line"></span><br><span class="line"> rpm -e --nodeps tzdata-java-2013g-1.el6.noarch</span><br></pre></td></tr></table></figure>
<ul>
<li>解压并配置环境变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">tar -zxvf /export/softwares/jdk-8u144-linux-x64.tar.gz -C /export/server</span><br><span class="line">ln -s jdk1.8.0_144 jdk8</span><br><span class="line"><span class="meta">#</span><span class="bash"> 打开环境变量配置文件</span></span><br><span class="line"> vim /etc/profile</span><br><span class="line"> or</span><br><span class="line"> vi /etc/profile</span><br><span class="line"> or</span><br><span class="line"> gedit /etc/profile</span><br></pre></td></tr></table></figure>
<ul>
<li>设置jdk环境变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/export/server/jdk1.8.0_144</span><br><span class="line">JRE_HOME=/export/server/jdk1.8.0_144/jre</span><br><span class="line">CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">export PATH JAVA_HOME CLASSPATH</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">使jdk环境变量立即生效</span></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
<ul>
<li>测试jdk安装成功且环境变量配置成功</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line">	java version "1.8.0_144"</span><br><span class="line">	Java(TM) SE Runtime Environment (build 1.8.0_144-b01)</span><br><span class="line">	Java HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode)</span><br><span class="line">javac -version</span><br><span class="line">	javac 1.8.0_144</span><br></pre></td></tr></table></figure>
<p>分发到其他节点</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /export/server/jdk8 vm02:/export/server/</span><br><span class="line">scp /etc/profile vm02:/etc/</span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>mysql安装</p>
</li>
<li><p>redis安装</p>
</li>
<li><p>nginx安装</p>
</li>
<li><p>tomcat安装</p>
</li>
<li><p>solr安装</p>
</li>
<li><p>ELK安装</p>
</li>
<li><p>zookeeper安装</p>
<p>zookeeper安装依赖于java JDK，需要先安装JDK，再解压安装zk，可以使用JDK的jps查看zk进程判断是否运行</p>
<ul>
<li>下载或上传安装包</li>
<li>解压</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf zookeeper-3.4.5.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash">或者使用如下命令解压到指定路径</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tar -zxvf zookeeper-3.4.5.tar.gz -C /<span class="built_in">export</span>/server</span></span><br><span class="line">mv zookeeper-3.4.5 zk</span><br></pre></td></tr></table></figure>
<ul>
<li>修改zookeeper配置文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /export/server/zk/conf</span><br><span class="line">cp zoo_sample.cfg zoo.cfg</span><br><span class="line">vim zoo.cfg</span><br></pre></td></tr></table></figure>
<ul>
<li>zoo.cfg文件添加如下内容</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 客户端连接端口，默认2181,可以省略</span></span><br><span class="line">clientPort = 2181</span><br><span class="line"><span class="meta">#</span><span class="bash"> 存储内存数据库快照的位置和放置事务日志的位置</span></span><br><span class="line">dataDir=/export/data/zookeeper</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (2888心跳端口、3888选举端口)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> server.x = [主机名]：nnnnn [：nnnnn]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 组成ZooKeeper集合的服务器</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zk01,zk02,zk03是配置在/etc/hosts中，可以不单独配置，直接使用原来的node01,node02,node03</span></span><br><span class="line">server.1=zk01:2888:3888</span><br><span class="line">server.2=zk02:2888:3888</span><br><span class="line">server.3=zk03:2888:3888</span><br></pre></td></tr></table></figure>
<ul>
<li>创建数据库快照文件存储路径</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /export/data/zookeeper</span><br></pre></td></tr></table></figure>
<ul>
<li>创建zk集群节点服务器编号文件myid</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 1 &gt; /export/server</span><br></pre></td></tr></table></figure>
<p>​</p>
<ul>
<li>将zk加入环境变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"><span class="meta">#</span><span class="bash">按键盘Go到文件末尾新空行</span></span><br><span class="line"><span class="meta">#</span><span class="bash">添加如下内容</span></span><br><span class="line"><span class="meta">#</span><span class="bash">设置zookeeper环境变量</span></span><br><span class="line">export ZK_HOME=/export/server/zookeeper-3.4.5</span><br><span class="line"><span class="meta">#</span><span class="bash">或者使用</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">export</span> ZK_HOME=/<span class="built_in">export</span>/server/zk</span></span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin:$ZK_HOME/bin</span><br></pre></td></tr></table></figure>
<ul>
<li><p>执行<figure class="highlight plain"><figcaption><span>/etc/profile```使得环境变量立即生效</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- 分发到zk集群的其他节点</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">#在zoo.cfg文件dataDir=/export/data/zookeeper指定位置创建myid</span><br><span class="line">#可以通过scp分发后修改myid文件中的数值或者到对应节点创建myid文件并写入对应编号，注意是依次编号不能重复</span><br><span class="line"></span><br><span class="line">###zk02节点的zk包和myid文件</span><br><span class="line">scp -r /export/server/zk node02:/export/server/</span><br><span class="line">scp -r /export/data/zookeeper/myid node02:/export/data/zookeeper</span><br><span class="line">echo 2 &gt; /export/data/zookeeper/myid</span><br><span class="line">###zk03节点zk包和myid文件</span><br><span class="line">scp -r /export/server/zk node03:/export/server/</span><br><span class="line">mkdir -p /export/data/zookeeper</span><br><span class="line">echo 3 &gt; /export/data/zookeeper/myid</span><br><span class="line">#配置或分发zk01环境变量zk02和zk03节点</span><br><span class="line">scp /etc/profile node02:/etc/profile</span><br><span class="line">scp /etc/profile node03:/etc/profile</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>测试</p>
</li>
<li>输入zk按两次tab键看zk相关命令脚本是否出现</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node02 ~]# zk</span><br><span class="line">zkCleanup.sh  zkCli.cmd     zkCli.sh      zkEnv.cmd     zkEnv.sh      zkServer.cmd  zkServer.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>启动zk集群</li>
<li><p>分别在zk01、zk02和zk03上执行<figure class="highlight plain"><figcaption><span>start```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```shell</span><br><span class="line">[root@node01 ~]# zkServer.sh start</span><br><span class="line">JMX enabled by default</span><br><span class="line">Using config: /export/servers/zookeeper-3.4.5/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>执行<figure class="highlight plain"><figcaption><span>server的进程**QuorumPeerMain**</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```shell</span><br><span class="line">[root@node01 ~]# jps</span><br><span class="line">1894 QuorumPeerMain</span><br><span class="line">1919 Jps</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>执行zkServer.sh status查看每个zk的运行状态及角色</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# zkServer.sh status</span><br><span class="line">JMX enabled by default</span><br><span class="line">Using config: /export/servers/zookeeper-3.4.5/bin/../conf/zoo.cfg</span><br><span class="line">Mode: follower</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node02 ~]# zkServer.sh status</span><br><span class="line">JMX enabled by default</span><br><span class="line">Using config: /export/servers/zookeeper-3.4.5/bin/../conf/zoo.cfg</span><br><span class="line">Mode: leader</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node03 ~]# zkServer.sh status</span><br><span class="line">JMX enabled by default</span><br><span class="line">Using config: /export/servers/zookeeper-3.4.5/bin/../conf/zoo.cfg</span><br><span class="line">Mode: follower</span><br></pre></td></tr></table></figure>
<p>执行<figure class="highlight plain"><figcaption><span>stop```停止zk服务</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  &gt; 3台zk集群的容错能力是1台（4台也是1）</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 其中一台挂掉后，另外两台可以继续正常工作</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 如果leader挂掉，重新投票选举leader</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 如果follower挂掉，leader不会改变</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 如果挂掉两台，剩下的一台zk节点无法正常工作</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 5台的zk集群的容错能力是2台，即最多允许两台zk节点服务器挂掉还能正常 工作。（6台也是2）</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 小结：zk集群一般是基数台（2n+1）,必须保证半数以上机器存活才能正常工作</span><br><span class="line"></span><br><span class="line">  ​</span><br><span class="line"></span><br><span class="line">  &gt; 集群配置参数节选</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; - server.x=[hostname]:nnnnn[:nnnnn], etc</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; &gt; (No Java system property)</span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; servers making up the ZooKeeper ensemble. When the server starts up, it determines which server it is by looking for the file myid in the data directory. That file contains the server number, in ASCII, and it should match **x** in **server.x** in the left hand side of this setting.</span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; The list of servers that make up ZooKeeper servers that is used by the clients must match the list of ZooKeeper servers that each ZooKeeper server has.</span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; There are two port numbers **nnnnn**. The first followers use to connect to the leader, and the second is for leader election. The leader election port is only necessary if electionAlg is 1, 2, or 3 (default). If electionAlg is 0, then the second port is not necessary. If you want to test multiple servers on a single machine, then different ports can be used for each server.</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; ​</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; - electionAlg</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; &gt; (No Java system property)</span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; Election implementation to use. </span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; - A value of &quot;0&quot; corresponds to the original UDP-based version, </span><br><span class="line">  &gt; &gt; - &quot;1&quot; corresponds to the non-authenticated UDP-based version of fast leader election,</span><br><span class="line">  &gt; &gt; - &quot;2&quot; corresponds to the authenticated UDP-based version of fast leader election, </span><br><span class="line">  &gt; &gt; - and &quot;3&quot; corresponds to TCP-based version of fast leader election. </span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; Currently, algorithm 3 is the default</span><br><span class="line">  &gt; &gt;</span><br><span class="line">  &gt; &gt; &gt; Note</span><br><span class="line">  &gt; &gt; &gt;</span><br><span class="line">  &gt; &gt; &gt; The implementations of leader election 0, 1, and 2 are now **deprecated **. We have the intention of removing them in the next release, at which point only the FastLeaderElection will be available.</span><br><span class="line"></span><br><span class="line">  [集群配置选项](http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_configuration)</span><br><span class="line"></span><br><span class="line">  [electionAlg=0集群无法恢复且日志无限打印的问题](https://issues.apache.org/jira/browse/ZOOKEEPER-2400)</span><br><span class="line"></span><br><span class="line">  - zookeeper的高性能参数配置</span><br><span class="line"></span><br><span class="line">  &gt; 为了在更新时获得较低的延迟，有一个专用的事务日志目录很重要。默认情况下，事务日志与数据快照和*myid*文件放在同一个目录中。dataLogDir参数指示用于事务日志的不同目录。</span><br><span class="line"></span><br><span class="line">  - 为什么需要配置两个端口server.1=zk01:2888:3888？</span><br><span class="line"></span><br><span class="line">  &gt;  follower连接到leader并与leader进行通信的TCP连接端口</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 默认的leader选举也是TCP协议，所以另一个端口作为leader选举端口。**即一个TCP协议通信端口，一个TCP协议leader选举端口（默认electionAlg=3，FastLeaderElection算法）**</span><br><span class="line"></span><br><span class="line">  zookeeper的安装运行</span><br><span class="line"></span><br><span class="line">- flume安装</span><br><span class="line"></span><br><span class="line">- hadoop安装</span><br><span class="line"></span><br><span class="line">- hive安装</span><br><span class="line"></span><br><span class="line">- azkaban安装</span><br><span class="line"></span><br><span class="line">- kafka安装</span><br><span class="line"></span><br><span class="line">- storm安装</span><br><span class="line"></span><br><span class="line">- sqoop安装</span><br><span class="line"></span><br><span class="line">- spark安装</span><br><span class="line"></span><br><span class="line">### 安装方式</span><br><span class="line"></span><br><span class="line">- 离线安装</span><br><span class="line">  - xxx.tar.gz的压缩包需要解压安装，有的需要解压+编译+安装</span><br><span class="line">  - rpm文件安装</span><br><span class="line"></span><br><span class="line">- 在线安装</span><br><span class="line"></span><br><span class="line">  - 对于某些包或软件可以选择在线安装</span><br><span class="line"></span><br><span class="line">  - 简单方便</span><br><span class="line"></span><br><span class="line">    ```shell</span><br><span class="line">    yum install nc</span><br><span class="line">    yum install lrzsz</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如果yum源中的软件版本过低，不满足需求，需要离线安装</li>
</ul>
</li>
</ul>

      
    </div>
    
    
    
	
	
	<div>
	  
		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
	  
	</div>
	
	
	
	<div>
		
			
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2018/03/12/distributed-software-install/">分布式集群</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 phoenix 的个人博客">phoenix</a></p>
  <p><span>发布时间:</span>2018年03月12日 - 06:03</p>
  <p><span>最后更新:</span>2018年03月12日 - 06:03</p>
  <p><span>原始链接:</span><a href="/2018/03/12/distributed-software-install/" title="分布式集群">http://www.bluedreams.top/2018/03/12/distributed-software-install/</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://www.bluedreams.top/2018/03/12/distributed-software-install/"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
	});
    });  
</script>

		
	</div>
	
	
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    

    

    
      <div id="bitcoin" style="display: inline-block">
        <img id="bitcoin_qr" src="/images/bitcoin-icon.png" alt="phoenix 比特币"/>
        <p>比特币</p>
      </div>
    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/bigdata/" rel="tag"><i class="fa fa-tag"></i> bigdata</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/02/06/tags/" rel="next" title="tags">
                <i class="fa fa-chevron-left"></i> tags
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/12/hadoop/" rel="prev" title="hadoop专题">
                hadoop专题 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/hz-avatar.png"
                alt="phoenix" />
            
              <p class="site-author-name" itemprop="name">phoenix</p>
              <p class="site-description motion-element" itemprop="description">use my code,change my world</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lusirbluesky" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://youtube.com/" target="_blank" title="YouTube">
                      
                        <i class="fa fa-fw fa-youtube"></i>YouTube</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://juejin.im/" title="掘金" target="_blank">掘金</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.51cto.com/" title="51CTO" target="_blank">51CTO</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.csdn.net/" title="CSDN" target="_blank">CSDN</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://zh.wikipedia.org/wiki/Wikipedia" title="维基百科" target="_blank">维基百科</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yq.aliyun.com/" title="云栖社区" target="_blank">云栖社区</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.zhihu.com/" title="知乎" target="_blank">知乎</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.uisdc.com/" title="优设" target="_blank">优设</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.zhangxinxu.com/" title="张鑫旭" target="_blank">张鑫旭</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.alloyteam.com/nav/" title="Web前端导航" target="_blank">Web前端导航</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.36zhen.com/t?id=3448" title="前端书籍资料" target="_blank">前端书籍资料</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://ife.baidu.com/" title="百度前端技术学院" target="_blank">百度前端技术学院</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://wf.uisdc.com/cn/" title="google前端开发基础" target="_blank">google前端开发基础</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#windows-Linux-OS是hosts文件"><span class="nav-number">1.</span> <span class="nav-text">windows/Linux OS是hosts文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#软件相关"><span class="nav-number">2.</span> <span class="nav-text">软件相关</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
	<!--
    <i class="fa fa-user"></i>
	-->
	<i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">phoenix</span>

  
</div>



  <div class="powered-by">
	<i class="fa fa-user-md"></i>
	<span id="busuanzi_container_site_uv">
		本站访客数(UV):<span id="busuanzi_value_site_uv"></span>
	</span>
	
	  <span class="post-meta-divider">|</span>
	
	<i class="fa fa-eye"></i>
	<span id="busuanzi_container_site_pv">
		本站点击量(PV):<span id="busuanzi_value_site_pv"></span>
	</span>
	
	  <span class="post-meta-divider">|</span>
	
	<i class="fa fa-pencil"></i>
	<span class="post-count">博客全站共23.9k字</span>
  </div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("kHJCmLiixRs7kLBKwgzMJ2ro-gzGzoHsz", "UK6t10H9lbjbvq0QeCeoovLV");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

  
<div id="hexo-helper-live2d">
  <canvas id="live2dcanvas" width="150" height="300"></canvas>
</div>
<style>
  #live2dcanvas{
    position: fixed;
    width: 150px;
    height: 300px;
    opacity:0.7;
    right: 0px;
    z-index: 999;
    pointer-events: none;
    bottom: -20px;
  }
</style>
<script type="text/javascript" src="/live2d/device.min.js"></script>
<script type="text/javascript">
const loadScript = function loadScript(c,b){var a=document.createElement("script");a.type="text/javascript";"undefined"!=typeof b&&(a.readyState?a.onreadystatechange=function(){if("loaded"==a.readyState||"complete"==a.readyState)a.onreadystatechange=null,b()}:a.onload=function(){b()});a.src=c;document.body.appendChild(a)};
(function(){
  if((typeof(device) != 'undefined') && (device.mobile())){
    var trElement = document.getElementById('hexo-helper-live2d');
    trElement.parentNode.removeChild(trElement);
    return;
  }else
    if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
  loadScript("/live2d/script.js", function(){loadlive2d("live2dcanvas", "/live2d/assets/wanko.model.json", 0.5);});
})();
</script>

</body>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
</html>
